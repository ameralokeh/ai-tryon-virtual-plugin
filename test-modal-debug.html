<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modal Debug Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .test-section {
            background: #f5f5f5;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }
        .button {
            background: #007cba;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 10px 5px;
        }
        .button:hover {
            background: #005a87;
        }
        .success {
            color: #46b450;
            font-weight: bold;
        }
        .error {
            color: #dc3232;
            font-weight: bold;
        }
        .warning {
            color: #ffb900;
            font-weight: bold;
        }
        .debug-output {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            margin: 10px 0;
            white-space: pre-wrap;
        }
        .step {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #007cba;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <h1>üîç Modal Debug Test</h1>
    
    <div class="test-section">
        <h2>Comprehensive Modal Debugging</h2>
        <p>This test will help diagnose exactly what's happening with the "Get More Credits" button.</p>
        
        <div class="step">
            <h3>Step 1: Clear Cache & Open Virtual Fitting Page</h3>
            <p>1. Press <strong>Ctrl+Shift+Delete</strong> to clear browser cache</p>
            <p>2. Open: <a href="http://localhost:8080/virtual-fitting-2/" target="_blank">Virtual Fitting Page</a></p>
            <p>3. Login with: <strong>hooktest</strong> / <strong>password</strong></p>
            <p>4. Open browser console (F12 ‚Üí Console tab)</p>
        </div>

        <div class="step">
            <h3>Step 2: Run Debug Commands</h3>
            <p>Copy and paste these commands in the browser console:</p>
            <div class="debug-output">// Check if modal exists in DOM
console.log('Modal exists:', $('#checkout-modal').length > 0);

// Check if modal has correct structure
console.log('Modal has loading div:', $('#checkout-loading').length > 0);
console.log('Modal has form container:', $('#checkout-form-container').length > 0);
console.log('Modal has success div:', $('#checkout-success').length > 0);
console.log('Modal has error div:', $('#checkout-error').length > 0);

// Check if functions are available
console.log('openCheckoutModal available:', typeof openCheckoutModal);
console.log('jQuery available:', typeof $ !== 'undefined');

// Check button exists and has correct ID
console.log('Button exists:', $('#add-credits-btn').length > 0);
console.log('Button is visible:', $('#add-credits-btn').is(':visible'));

// Test the modal function directly
if (typeof openCheckoutModal === 'function') {
    console.log('Testing modal function...');
    openCheckoutModal();
} else {
    console.error('openCheckoutModal function not available!');
}</div>
        </div>

        <div class="step">
            <h3>Step 3: Manual Button Test</h3>
            <p>After running the debug commands, try clicking the "Get More Credits" button.</p>
            <p><strong>Expected Results:</strong></p>
            <ul>
                <li>‚úÖ Modal should appear with loading spinner</li>
                <li>‚úÖ Background should be dimmed</li>
                <li>‚úÖ Checkout form should load after a moment</li>
                <li>‚úÖ Payment methods should be visible</li>
                <li>‚ùå Should NOT redirect to shop page</li>
            </ul>
        </div>

        <div class="step">
            <h3>Step 4: Check for JavaScript Errors</h3>
            <p>Look in the browser console for any red error messages. Common issues:</p>
            <ul>
                <li><span class="error">Uncaught TypeError:</span> Function not defined</li>
                <li><span class="error">Uncaught ReferenceError:</span> Variable not found</li>
                <li><span class="warning">404 errors:</span> JavaScript files not loading</li>
                <li><span class="error">AJAX errors:</span> Server-side issues</li>
            </ul>
        </div>
    </div>

    <div class="test-section">
        <h2>Quick Local Test</h2>
        <p>Test the modal functionality on this page:</p>
        
        <button class="button" onclick="testModalLocally()">Test Modal Function Locally</button>
        <div id="local-test-result" style="margin-top: 10px;"></div>
        
        <div id="test-modal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.8); z-index: 10000;">
            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 30px; border-radius: 8px; max-width: 400px;">
                <h3>Test Modal</h3>
                <p>This is a test modal to verify modal functionality works.</p>
                <button class="button" onclick="closeTestModal()">Close Modal</button>
            </div>
        </div>
    </div>

    <div class="test-section">
        <h2>Troubleshooting Guide</h2>
        
        <h3>If Modal Still Doesn't Appear:</h3>
        <ol>
            <li><strong>Check Console Errors:</strong> Look for JavaScript errors in F12 console</li>
            <li><strong>Verify Scripts Loading:</strong> Check Network tab for 404 errors on JS files</li>
            <li><strong>Clear All Cache:</strong> Try incognito/private browsing mode</li>
            <li><strong>Check Modal HTML:</strong> Verify #checkout-modal exists in page source</li>
            <li><strong>Test Function Availability:</strong> Run debug commands above</li>
        </ol>

        <h3>If Modal Appears But Doesn't Work:</h3>
        <ol>
            <li><strong>Check AJAX Endpoints:</strong> Look for 500/404 errors in Network tab</li>
            <li><strong>Verify WooCommerce:</strong> Ensure WooCommerce is active and configured</li>
            <li><strong>Check Payment Methods:</strong> Verify payment gateways are enabled</li>
            <li><strong>Test Cart Operations:</strong> Check if cart add/clear functions work</li>
        </ol>

        <h3>Success Indicators:</h3>
        <ul>
            <li>‚úÖ Console shows: "Modal exists: true"</li>
            <li>‚úÖ Console shows: "openCheckoutModal available: function"</li>
            <li>‚úÖ Modal appears when button is clicked</li>
            <li>‚úÖ Loading spinner shows initially</li>
            <li>‚úÖ Checkout form loads with payment options</li>
            <li>‚úÖ No JavaScript errors in console</li>
        </ul>
    </div>

    <script>
        function testModalLocally() {
            const resultDiv = document.getElementById('local-test-result');
            const modal = document.getElementById('test-modal');
            
            resultDiv.innerHTML = '<span class="success">‚úÖ Local modal test successful! Opening test modal...</span>';
            modal.style.display = 'block';
        }
        
        function closeTestModal() {
            document.getElementById('test-modal').style.display = 'none';
        }
        
        // Close modal when clicking outside
        document.getElementById('test-modal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeTestModal();
            }
        });
    </script>
</body>
</html>